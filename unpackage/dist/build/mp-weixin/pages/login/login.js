"use strict";var e=require("../../common/vendor.js"),o=require("../../api/login.js"),a=require("../../stores/user.js");require("../../api/request.js");const t=a.useUserStore(),r={data:()=>({captcha:"https://blog.zhoulizheng.cn:6816/api/captcha?",avatar:"http://qiniu.zhoulizheng.cn/43507260-9412-4a12-88f4-eddb2c3a858f.jpg",formData:{name:"",password:"",code:""},rules:{name:{rules:[{required:!0,errorMessage:"请输入姓名"},{minLength:3,maxLength:5,errorMessage:"姓名长度在 {minLength} 到 {maxLength} 个字符"}]},code:{rules:[{required:!0,errorMessage:"请输入验证码"}]},password:{rules:[{required:!0,errorMessage:"请输入密码"}]}}}),onLoad(){this.getCaptcha()},methods:{submit(){this.$refs.form.validate().then((a=>{let{name:r,password:s,code:n}=a;o.loginApi.login(r,s,n).then((o=>{console.log(o,"result");let a=o.data.token;if(console.log(a,"token"),t.setToken(a),e.index.setStorageSync("token",a),200===o.code)return e.index.reLaunch({url:"/pages/index/index"}),e.index.showToast({title:"登录成功！",icon:"none"})})),console.log("表单数据信息：",a)})).catch((e=>{console.log("表单错误信息：",e)}))},getCaptcha(){o.loginApi.getCode().then((e=>{this.captcha=this.captcha+new Date}))},register(){e.index.navigateTo({url:"/pages/register/register"})},reset(){this.formData.code="",this.formData.name="",this.formData.password=""}}};if(!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms/uni-forms.js"))();var s=e._export_sfc(r,[["render",function(o,a,t,r,s,n){return{a:s.avatar,b:e.o((e=>s.formData.name=e)),c:e.p({type:"text",placeholder:"请输入账号",modelValue:s.formData.name}),d:e.p({label:"账号",name:"name"}),e:e.o((e=>s.formData.password=e)),f:e.p({type:"password",placeholder:"请输入密码",modelValue:s.formData.password}),g:e.p({label:"密码",name:"password"}),h:e.o((e=>s.formData.code=e)),i:e.p({type:"text",placeholder:"请输入验证码",modelValue:s.formData.code}),j:s.captcha,k:e.o(((...e)=>n.getCaptcha&&n.getCaptcha(...e))),l:e.p({label:"验证码",name:"code"}),m:e.sr("form","0612c887-0"),n:e.p({modelValue:s.formData,rules:s.rules}),o:e.o(((...e)=>n.submit&&n.submit(...e))),p:e.o(((...e)=>n.reset&&n.reset(...e)))}}]]);wx.createPage(s);
